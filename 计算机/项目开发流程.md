

web视频播放项目项目例子 



先对分析需要那些功能模块 >>> 然后设计功能模块的表设计，顺便分析架构



## 包架构模块

![image-20241125012652198](./项目开发流程.assets/image-20241125012652198.png)



### PO

PO是`持久化对象`，用于表示数据库中的实体或表的映射通常与数据库表的结构和字段对应PO的属性对应数据库表的字段，可以进行持久化操作（新增、查询、更新、删除）



### VO

VO是`视图对象`，用于封装数据通常是不可变的，用于传递数据而不包含业务逻辑VO可以用于在不同层之间传递数据，如前端和后端之间，后端的返回的到前端的数据只需要保留必要的字段就可以将这些必要的字段封装起来就是VO



### BO
BO是`业务对象`，用于封装业务逻辑和操作包含与业务相关的方法和属性，用于实现业务规则和操作
BO通常与领域模型紧密相关，用于表示业务概念和业务流程


### DO
DO通常与BO和PO相对应，用于实现领域模型和业务逻辑，用于表示从数据存储中得到的数据


### DAO
DAO是`数据访问对象`，用于封装对数据库的访问操作，也就是我们常说的Dao层提供对数据库的增删改查等操作的接口,DAO可以隐藏底层数据库的具体实现细节，使得业务逻辑层与数据库解耦

### DTO
DTO是`数据传输对象`，用于在不同层之间传输数据通常用于优化数据传输的性能和减少网络通信的开销。DTO可以封装多个对象的数据，以减少网络请求次数。如果说VO一般用于前端和后端之后传输数据，那么DTO就是在后端的不同层之间传递数据，例如controller层和service层或者在服务之间结构调用的时候使用DTO


### POJO
POJO是一个简单的Java对象，没有特定的限制和约束，是一种普通的Java类，不依赖于特定的框架或接口


## 需求分析

分析功能模块有哪些

既然是一个视频播放的项目那么就需要以下模块

1. 用户模块
    - 登录/注册（对外暴露的接口需要验证）
      - 邮箱注册/登录（邮箱注册/登录验证码防刷）
      - 浏览记录&搜索记录
     - 用户浏览视频被存储（用户停留视频多少s才保留记录）
     - 用户搜索记录被记录
      - 收藏夹
     - 可以对视频收藏分类管理
      - 订阅分类（实现推送机制）&关注/粉丝
     - 订阅后推送相似视频
     - 推送关注用户视频 
2. 管理模块
3. 内容审核模块
	- 文本审核（用户昵称，视频标题与描述）（提取出来给所有包含文字审核的做服务：中台服务）
	- 图片审核  (用户头像，视频封面)
	- 视频审核（用户发布的视频）
4. 视频模块
	- 相似视频推送
	
	   - 热度排行榜
	
	   - 分类推送
	
	   - 关注推送
	
	   - 兴趣推送
	
	   - 热门视频推送
	
	   - 相似视频推送 
	
	- 用户互动
		- 用户浏览视频
		- 点赞，收藏，分享和搜索视频 
	
	- 视频管理
		- 发布视频和下架视频
		- 编辑视频描述
		- 播放视频 
5. 资源保护模块（防止流量盗刷）
   - 视频防盗
   - 图片防盗

## 技术选型&架构设计



## 表设计

baseEntity在应用层层面 封装统一字段 Bo继承baseEntity

公共字段：创建时间，修改时间，逻辑删除等等

#### 视频模块

##### 视频表video

视频id 
视频标题 
视频描述 
视频发布用户id 
视频源 文件表id-->通过文件表id获取key（资源地址)
视频封面 文件表id-->通过文件表id获取key（资源地址)
标签 
审核状态：通过审核中 PASS
状态：公开 私密
审核结果：正常，null，审核违规信息
点赞次数
收藏次数 
分享次数 

##### 分类表type

分类id
名称
标签

##### 视频分类中间表video_type

id
分类id
视频id

##### 视频点赞表kudos

id
视频id
点赞用户id

##### 视频分享表share

id
视频id
分享（用户）id
ip 



#### 内容审核模块

##### 系统配置表

自动通过

人工审核

PASS



#### 资源保护模块

##### 文件表

设计这里的时候将 源视频表的视频源，封面字段 更改

id

key

文件类型

文件大小

视频时长

....





#### 用户模块

RBAC（基于角色的访问控制）：将角色与具体的权限绑定（绑定后极少修改），如此某个角色对应有哪些权限（能干什么，不能干什么），然后再给用户分配所需要的角色，这样，每个分配了不同角色的用户也就有了不同的能力。

经典五张表：

##### 用户表user_info

id

昵称

账号

密码

介绍

头像性别

创建时间

##### 用户角色关系表user_role_info

id

用户id

角色id

##### 角色表role_info

id

角色名称

##### 角色权限关系表role_permission_info

id

权限id

角色id

##### 权限表permission_info

id

权限名称

菜单权限

排序



##### 浏览记录

不建议存到本地数据库，用户量大了访问不过来，存到redis中使用zset存储，设置ttl几个星期

##### 搜索记录

也是上述设计

##### 收藏夹表

id

名称

介绍

收藏夹视频数量

创建时间

创建者id（用户id）

##### 收藏夹视频中间表

id

收藏夹id

视频id

##### 订阅分类表

id

用户id

分类id：感兴趣分类id

##### 关注粉丝

id

关注id

粉丝id







## 落地实现

就是具体功能的实现

## 横向考虑

